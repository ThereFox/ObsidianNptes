# Примитивные

В System

int, float, bool, char, object, string и д.р.

>[!Info] Decimal
>Не является примитивом

Могут быть записаны литералами (123, 12.3, "text")
Выражения с литералами вычисляются на этапе компиляции

## Переполнение

Проверка переполнения, по умолчанию, отключена

блок с включенной проверкой переполнения: checked(...) или checked{...}
с выключенным: unchecked(...) или unchecked{...}

# Ссылочные

Все наследуются от System.Object

Классы

## Особенности работы 

- Передаются в методы по ссылке (т.е. копируется ссылка на объект)
- Инициализируются null
- Может быть несколько ссылок на один и тот же объект

## Память

- Память для таких типов всегда выделяется из кучи
- Подпадают под сборку мусора
- В стеке хранится адрес объекта в памяти
# Значимые

Все являются потомками System.Object => System.ValueType

> [!info] Enum
> Производные от System.ValueType => System.Enum

## Особенности работы

- Передаются в методы по значению (т.е. значение копируется в новую переменную)
- Equals сравнивает значения всех полей
- GetHashCode учитывает значения полей экземпляра
- Инициализируются 0-ом

## Память

- Обычно память для таких объектов располагается в стеку потока, но если являет частью ссылочното типа, то в куче
- Не попадает под сборку мусора

## Особенности наследования

- Не могут выбрать произвольный базовый тип, но могут реализовать интерфейсы
- Являются запечатанными (sealed) 



## Когда использовать

Если
- значения иммутабельны
- не имеет особого базового типа
- не имеет производных
- 1 из 
	- размер экземпляра мал (<= 16 байт) + передаётся в методы или возвращается из них
	- размер экземпляров велик(=> 16 байт) + не передается в методы и не возвращается из них 



## Упаковка и распаковка

### Упаковка

Преобразование значимого типа в ссылочный - называется упаковкой
(т.е. перевод значения из стека в кучу)

При ней происходит
- Выделение памяти в куче (память которую объект занимал в стеке + ссылка на Type и индекс блока синхронизации)
- Копирование полей
- Возвращение адреса

### Распаковка

Распаковка - процесс получения ссылки на значимый тип (находящийся в куче).

Часто вслед за ней следует копирование полей в стек
(при условии присвоения полученного в переменную значимого типа)

Менее ресурсозатратная.

> [!info] Обобщения
> При обобщённых коллекциях (и подобных элементах принимающих T)
> Упаковка и распаковка не происходит

> [!warning] Приведение к интерфейсам
> Передача по интерфейсу значимых типов вызывает упаковку

